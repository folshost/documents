\documentclass[10pt]{standalone}

\usepackage{tikz}
\usetikzlibrary{shapes,calc,backgrounds,shadows, arrows, snakes, decorations.pathmorphing, decorations.pathreplacing}

\ifxetex
\usepackage{fontspec}
      \defaultfontfeatures{Mapping=tex-text}
      \setmainfont[Path = fonts/,ItalicFont={gillsansmtpro-bookitalic-opentype.otf}]{gillsansmtpro-book-opentype.otf}
      \setsansfont[Path = fonts/,ItalicFont={gillsansmtpro-bookitalic-opentype.otf}]{gillsansmtpro-book-opentype.otf}
      \setmonofont[Path = fonts/]{inconsolata-opentype.otf}
      \newcommand{\codefont}{\ttfamily}
\else
      \usepackage[utf8x]{inputenc}
      \usepackage[nott]{inconsolata}
      \newcommand{\codefont}{\fontfamily{fi4}\selectfont}
\fi

\usepackage{color}
\usepackage{xcolor}

\definecolor{lsupurple}{RGB}{70,29,124}

\tikzstyle{every picture}+=[remember picture]
\tikzstyle{na} = [baseline=-5px]
\tikzstyle{queue_item} = [rectangle, minimum height=14px]
\tikzset{snake it/.style={decorate, decoration=snake}}

\begin{document}
  \begin{tikzpicture}
      \tikzstyle{box}=[minimum width = 4em, color = lsupurple, line width = 0.5mm, draw, node distance = 5em, text=black];
      \tikzstyle{line}=[thick, color = lsupurple, line width=0.5mm];

      \node (global_memory) [fill = gray!25, draw = gray!25, minimum width=31.5em, minimum height=6em, xshift=15.5em, yshift=4.25em, text = gray] {};

      \node (locality_0) [box, minimum height=10em, xshift=2.5em, label={Locality $0$}, yshift=2em] {};
      \node (locality_1) [box, minimum height=10em, xshift=8.5em, label={Locality $1$}, yshift=2em] {};
      \node (locality_i) [box, minimum height=10em, xshift=18.5em, label={Locality $i$}, yshift=2em] {};
      \node (locality_n) [box, minimum height=10em, xshift=28.5em, label={Locality $N-1$}, yshift=2em] {};

      \node (agas) [box, minimum height=1.5em, below of = locality_0, yshift = -1.5em, minimum width = 30em, xshift=13em] {Parcelport};
      \node (pp) [box, minimum height=1.5em, below of = agas, yshift = 3em, minimum width = 30em] {AGAS};

      \node (tm_0) [box, minimum height=1.5em, below of = locality_0, yshift = -6em, align=center] {CPUs \\ GPUs};

      \node (tm_1) [box, minimum height=1.5em, below of = locality_1, yshift = -6em, align=center] {CPUs \\ GPUs};

      \node (tm_i) [box, minimum height=1.5em, below of = locality_i, yshift = -6em, align=center] {CPUs \\ GPUs};

      \node (tm_n) [box, minimum height=1.5em, below of = locality_n, yshift = -6em, align=center] {CPUs \\ GPUs};

      \path
      (tm_0.west) edge [line] node {} (tm_0.east)
      (tm_1.west) edge [line] node {} (tm_1.east)
      (tm_i.west) edge [line] node {} (tm_i.east)
      (tm_n.west) edge [line] node {} (tm_n.east);

      \path
      ($(locality_1.east) + (1.0em, 0.0em)$) edge [line, dashed] node {} ($(locality_i.west) - (1.0em, 0.0em)$)
      ($(locality_i.east) + (1.0em, 0.0em)$) edge [line, dashed] node {} ($(locality_n.west) - (1.0em, 0.0em)$);

      \node (comp0_0) [fill = lsupurple!70, xshift = 1.5em, yshift = 6em] {};
      \node (comp1_0) [fill = lsupurple!70, xshift = 2.5em, yshift = 5.5em] {};
      \node (comp2_0) [fill = lsupurple!70, xshift = 2.0em, yshift = 4em] {};
      \node (comp3_0) [fill = lsupurple!70, xshift = 3.5em, yshift = 5em] {};
      \node (comp4_0) [fill = lsupurple!70, xshift = 3.5em, yshift = 3em] {};
      \node (comp5_0) [fill = lsupurple!70, xshift = 3.5em, yshift = 6em] {};

      \node (comp0_1) [fill = lsupurple!70, xshift = 7.25em, yshift = 6em] {};
      \node (comp1_1) [fill = lsupurple!70, xshift = 8.25em, yshift = 5.5em] {};
      \node (comp2_1) [fill = lsupurple!70, xshift = 7.75em, yshift = 4em] {};
      \node (comp3_1) [fill = lsupurple!70, xshift = 9.25em, yshift = 5em] {};
      \node (comp4_1) [fill = lsupurple!70, xshift = 9.25em, yshift = 3em] {};
      \node (comp5_1) [fill = lsupurple!70, xshift = 9.25em, yshift = 6em] {};

      \node (comp0_2) [fill = lsupurple!70, xshift = 17.25em, yshift = 6em] {};
      \node (comp1_2) [fill = lsupurple!70, xshift = 18.25em, yshift = 5.5em] {};
      \node (comp2_2) [fill = lsupurple!70, xshift = 17.75em, yshift = 4em] {};
      \node (comp3_2) [fill = lsupurple!70, xshift = 19.25em, yshift = 5em] {};
      \node (comp4_2) [fill = lsupurple!70, xshift = 19.25em, yshift = 3em] {};
      \node (comp5_2) [fill = lsupurple!70, xshift = 19.25em, yshift = 6em] {};

      \node (comp0_3) [fill = lsupurple!70, xshift = 27.25em, yshift = 6em] {};
      \node (comp1_3) [fill = lsupurple!70, xshift = 28.25em, yshift = 5.5em] {};
      \node (comp2_3) [fill = lsupurple!70, xshift = 27.75em, yshift = 4em] {};
      \node (comp3_3) [fill = lsupurple!70, xshift = 29.25em, yshift = 5em] {};
      \node (comp4_3) [fill = lsupurple!70, xshift = 29.25em, yshift = 3em] {};
      \node (comp5_3) [fill = lsupurple!70, xshift = 29.25em, yshift = 6em] {};

      \node (id0_0) [fill = gray!70, xshift = 1.5em, yshift = 0.5em] {};
      \node (id1_0) [fill = gray!70, xshift = 2.5em, yshift = 0em] {};
      \node (id2_0) [fill = gray!70, xshift = 2.0em, yshift = -1.5em] {};
      \node (id3_0) [fill = gray!70, xshift = 3.5em, yshift = -1.5em] {};
      \node (id4_0) [fill = gray!70, xshift = 3.5em, yshift = -0.5em] {};
      \node (id5_0) [fill = gray!70, xshift = 3.5em, yshift = 0.5em] {};

      \node (id0_1) [fill = gray!70, xshift = 7.25em, yshift = 0.5em] {};
      \node (id1_1) [fill = gray!70, xshift = 8.25em, yshift = 0em] {};
      \node (id2_1) [fill = gray!70, xshift = 7.75em, yshift = -1.5em] {};
      \node (id3_1) [fill = gray!70, xshift = 9.25em, yshift = -1.5em] {};
      \node (id4_1) [fill = gray!70, xshift = 9.25em, yshift = -0.5em] {};
      \node (id5_1) [fill = gray!70, xshift = 9.25em, yshift = 0.5em] {};

      \node (id0_2) [fill = gray!70, xshift = 17.25em, yshift = 0.5em] {};
      \node (id1_2) [fill = gray!70, xshift = 18.25em, yshift = 0em] {};
      \node (id2_2) [fill = gray!70, xshift = 17.75em, yshift = -1.5em] {};
      \node (id3_2) [fill = gray!70, xshift = 19.25em, yshift = -1.5em] {};
      \node (id4_2) [fill = gray!70, xshift = 19.25em, yshift = -0.5em] {};
      \node (id5_2) [fill = gray!70, xshift = 19.25em, yshift = 0.5em] {};

      \node (id0_3) [fill = gray!70, xshift = 27.25em, yshift = 0.5em] {};
      \node (id1_3) [fill = gray!70, xshift = 28.25em, yshift = 0em] {};
      \node (id2_3) [fill = gray!70, xshift = 27.75em, yshift = -1.5em] {};
      \node (id3_3) [fill = gray!70, xshift = 29.25em, yshift = -1.5em] {};
      \node (id4_3) [fill = gray!70, xshift = 29.25em, yshift = -0.5em] {};
      \node (id5_3) [fill = gray!70, xshift = 29.25em, yshift = 0.5em] {};

      \path (id0_0) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp0_0);
      \path (id1_0) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp1_1);
      \path (id2_0) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp2_2);
      \path (id3_0) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp3_3);
      \path (id4_0) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp4_3);
      \path (id5_0) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp5_1);

      \path (id0_1) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp0_3);
      \path (id1_1) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp1_2);
      \path (id2_1) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp2_1);
      \path (id3_1) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp3_0);
      \path (id4_1) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp4_2);
      \path (id5_1) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp5_2);

      \path (id0_2) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp0_2);
      \path (id1_2) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp1_1);
      \path (id2_2) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp2_3);
      \path (id3_2) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp3_0);
      \path (id4_2) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp4_1);
      \path (id5_2) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend left] node {} (comp5_1);

      \path (id0_3) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend right] node {} (comp0_0);
      \path (id1_3) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend right] node {} (comp1_0);
      \path (id2_3) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend right] node {} (comp2_1);
      \path (id3_3) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend right] node {} (comp3_2);
      \path (id4_3) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend right] node {} (comp4_3);
      \path (id5_3) edge [- triangle 45, dashed, line width = 0.2mm, color = gray, bend right] node {} (comp5_3);
  \end{tikzpicture}

\end{document}
